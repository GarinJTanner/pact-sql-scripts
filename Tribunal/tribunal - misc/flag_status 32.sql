SELECT distinct u.id, u.login, u.email, d.udid, d.fraudulent as 'device_fraudulent?', u.login, u.flag_status as '32 == user_fraudulent?', u.updated_at FROM users_devices ud, devices d, users u WHERE ud.device_id IN (select ud.device_id from users_devices ud, users u where ud.user_id = u.id and u.email in (select email from users where id=@user_id)) AND d.id = ud.device_id AND u.id = ud.user_id